{"version":3,"sources":["../src/at.js"],"names":["_animate","require","_chart","_container","_e","Element","_layout","_l","_logo","_n","Scene","Stage","_util","find","_tobj","Constants","prototype","createStageFromJson","jsonStr","$canvas","jsonObj","eval","$stage","k","scenes","childs","forEach","sce","$sce","key","background","childItems","item","tempEle","type","elementType","Node","CircleNode","proKey","add","loadStageFromJson","json","stageObj","obj","stage","i","length","sceneObj","$scene","p","nodeMap","elements","m","elementObj","element","mk","text","console","log","getElementsBound","a","b","left","Number","MAX_VALUE","right","MIN_VALUE","top","bottom","c","d","Link","x","leftNode","width","rightNode","y","topNode","height","bottomNode","module","exports","AEffect","Effect","Animate","BarChartNode","PieChartNode","Container","DisplayElement","InteractiveElement","EditableElement","Layout","layout","FoldLink","FlexionalLink","CurveLink","Logo","TextNode","LinkNode","AnimateNode","Util","Tobj"],"mappings":"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","file":"at.js","sourcesContent":["//////////////////////////////\n/**\n * 主入口\n * @author ilex\n * @doc\n *  import _aot from 'amos-overt';\n */\n//////////////////////////////\nlet _animate = require('./_animate');\nlet _chart = require('./_chart');\nlet _container = require('./_container');\nlet _e = require('./_baseElement');\nlet Element = require('./_absElement');\nlet _layout = require('./_layout');\nlet _l = require('./_link');\nlet _logo = require('./_logo');\nlet _n = require('./_node');\nlet Scene = require('./_scene');\nlet Stage = require('./_stage');\nlet _util = require('./_util');\nlet find = require('./_extends');\nlet _tobj = require('./_tobj');\nlet Constants = require('./constants/index');\n\nStage.prototype.find = find,\nScene.prototype.find = find;\n\n/**\n * 从json文件创建\n *\n * @param {any} jsonStr\n * @param {any} canvas\n * @returns\n */\nfunction createStageFromJson(jsonStr, $canvas) {\n  let jsonObj;\n  eval('jsonObj = ' + jsonStr);\n  let $stage = new Stage($canvas);\n  for (let k in jsonObj) { 'childs' != k && ($stage[k] = jsonObj[k]); }\n  let scenes = jsonObj.childs;\n  return scenes.forEach(function(sce) {\n    let $sce = new Scene($stage);\n    for (let key in sce) {\n      'childs' != key && ($sce[key] = sce[key]),\n        'background' == key && ($sce.background = sce[key]);\n    }\n    let childItems = sce.childs;\n    childItems.forEach(function(item) {\n      let tempEle = null,\n        type = item.elementType;\n      'node' == type ? tempEle = new _n.Node : 'CircleNode' == type && (tempEle = new _n.CircleNode);\n      for (let proKey in item) { tempEle[proKey] = item[proKey]; }\n      $sce.add(tempEle);\n    });\n  }),\n    $stage;\n}\n\n/**\n * 从json文件加载\n *\n * @param {any} json\n * @param {any} canvas\n * @returns\n */\n_util.loadStageFromJson = function loadStageFromJson(json, $canvas) {\n  let stageObj;\n  let obj = eval(json),stage = new Stage($canvas);\n  for (let k in stageObj) {\n    if ('scenes' != k) { stage[k] = obj[k]; }\n    else {\n      for (let scenes = obj.scenes, i = 0; i < scenes.length; i++) {\n        let sceneObj = scenes[i],\n          $scene = new Scene(stage);\n        for (let p in sceneObj) {\n          if ('elements' != p) { $scene[p] = sceneObj[p]; }\n          else {\n            for (let nodeMap = {}, elements = sceneObj.elements, m = 0; m < elements.length; m++) {\n              let elementObj = elements[m], type = elementObj.elementType, element;\n              'Node' == type && (element = new Node);\n              for (let mk in elementObj) { element[mk] = elementObj[mk]; }\n              nodeMap[element.text] = element,\n                $scene.add(element);\n            }\n          }\n        }\n      }\n    }\n  }\n  return console.log(stage),stage;\n};\n\n_util.getElementsBound = function getElementsBound(a) {\n  let b = {\n    left: Number.MAX_VALUE,\n    right: Number.MIN_VALUE,\n    top: Number.MAX_VALUE,\n    bottom: Number.MIN_VALUE\n  };\n  for (let c = 0; c < a.length; c++) {\n    let d = a[c];\n    d instanceof _l.Link || (b.left > d.x && (b.left = d.x, b.leftNode = d), b.right < d.x + d.width && (b.right = d.x + d.width, b.rightNode = d), b.top > d.y && (b.top = d.y, b.topNode = d), b.bottom < d.y + d.height && (b.bottom = d.y + d.height, b.bottomNode = d));\n  }\n  return b.width = b.right - b.left,\n    b.height = b.bottom - b.top,\n    b;\n};\n\nmodule.exports = {\n  AEffect: _animate.Effect,\n  Animate: _animate.Animate,\n  BarChartNode: _chart.BarChartNode,\n  PieChartNode: _chart.PieChartNode,\n  Container: _container,\n  DisplayElement: _e.DisplayElement,\n  InteractiveElement: _e.InteractiveElement,\n  EditableElement: _e.EditableElement,\n  Element: Element,\n  Layout: _layout,\n  layout: _layout,\n  Link: _l.Link,\n  FoldLink: _l.FoldLink,\n  FlexionalLink: _l.FlexionalLink,\n  CurveLink: _l.CurveLink,\n  Logo: _logo,\n  Node: _n.Node,\n  TextNode: _n.TextNode,\n  LinkNode: _n.LinkNode,\n  CircleNode: _n.CircleNode,\n  AnimateNode: _n.AnimateNode,\n  Util: _util,\n  Scene: Scene,\n  Stage: Stage,\n  Tobj:_tobj,\n  createStageFromJson: createStageFromJson,\n  Constants: Constants\n};\n"]}