{"version":3,"sources":["../src/_extends.js"],"names":["Stage","require","Scene","filterResults","items","condition","result","length","filterCond","match","tempRes","filter","item","elementType","concat","flag","eleType","prop2","sign","val3","tempRes2","otherItem","val2","parseInt","events","split","invokeProperty","arr","find","cond","call","forEach","ev","tar","i","key","value","val","temp","j","push","apply","arguments","attr","itemProperty","itemValue","attrTemp","m","n","itKey","tempArrays","childs","tempItem","module","exports"],"mappings":"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","file":"_extends.js","sourcesContent":["//////////////////////////////\n/**\n * 针对stage和scene进行扩展\n * 舞台\n * @author ilex\n * @description 2016-11-05 11:56:12\n */\n//////////////////////////////\n\nconst Stage = require('./_stage');\nconst Scene = require('./_scene');\n\n/**\n * 筛选结果\n *\n * @param {any} items 目标集合\n * @param {any} condition 条件\n * @returns\n */\nfunction filterResults(items, condition) {\n  let result = [];\n  if (0 === items.length) {\n    return result;\n  }\n  let filterCond = condition.match(/^\\s*(\\w+)\\s*$/);\n  if (null != filterCond) {\n    let tempRes = items.filter(function(item) {\n      return item.elementType == filterCond[1];\n    });\n    null != tempRes && tempRes.length > 0 && (result = result.concat(tempRes));\n  } else {\n    let flag = false;\n    filterCond = condition.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*['\"](\\S+)['\"]\\s*\\]\\s*/),\n    (null == filterCond || filterCond.length < 5) && (filterCond = condition.match(/\\s*(\\w+)\\s*\\[\\s*(\\w+)\\s*([>=<])\\s*(\\d+(\\.\\d+)?)\\s*\\]\\s*/), flag = true);\n    if (null != filterCond && filterCond.length >= 5) {\n      let eleType = filterCond[1],\n        prop2 = filterCond[2],\n        sign = filterCond[3],\n        val3 = filterCond[4];\n      let tempRes2 = items.filter(function(otherItem) {\n        if (otherItem.elementType != eleType) {\n          return false;\n        }\n        let val2 = otherItem[prop2];\n        return true === flag && (val2 = parseInt(val2)),\n            '=' == sign ? val2 == val3 : '>' == sign ? val2 > val3 : '<' == sign ? val3 > val2 : '<=' == sign ? val3 >= val2 : '>=' == sign ? val2 >= val3 : '!=' == sign ? val2 != val3 : false;\n      });\n      null != tempRes2 && tempRes2.length > 0 && (result = result.concat(tempRes2));\n    }\n  }\n  return result;\n}\n\nlet events = 'click,mousedown,mouseup,mouseover,mouseout,mousedrag,keydown,keyup'.split(',');\n\n/**\n * 给查询结果注入属性\n *\n * @param {any} arr 数组\n * @returns\n */\nfunction invokeProperty(arr) {\n  // 注入find方法\n  arr.find = function(cond) {\n    return find.call(this, cond);\n  };\n  // 注入事件\n  events.forEach(function(ev) {\n    arr[ev] = function(tar) {\n      for (let i = 0; i < this.length; i++) {\n        this[i][ev](tar);\n      }\n      return this;\n    };\n  });\n  if (arr.length > 0) {\n    let item = arr[0];\n    for (let key in item) {\n      let value = item[key];\n      'function' == typeof value && !function(val) {\n        arr[key] = function() {\n          let temp = [];\n          for (let j = 0; j < arr.length; j++) {\n            temp.push(val.apply(arr[j], arguments));\n          }\n          return key;\n        };\n      }(value);\n    }\n  }\n  return arr.attr = function(itemProperty, itemValue) {\n    if (null != itemProperty && null != itemValue) {\n      for (let j = 0; j < this.length; j++) {\n        this[j][itemProperty] = itemValue;\n      }\n    } else {\n      if (null != itemProperty && 'string' == typeof itemProperty) {\n        let attrTemp = [];\n        for (let m = 0; m < this.length; m++) {\n          attrTemp.push(this[m][itemProperty]);\n        }\n        return attrTemp;\n      }\n      if (null != itemProperty) {\n        for (let n = 0; n < this.length; n++) {\n          for (let itKey in itemProperty) {\n            this[n][itKey] = itemProperty[itKey];\n          }\n        }\n      }\n    }\n    return this;\n  },\n    arr;\n}\n\n/**\n * 公用查找方法\n *\n * @param {any} condition 查找条件(string | function)\n * @returns\n */\nfunction find(condition) {\n  let tempRes = [],\n    tempArrays = [];\n  this instanceof Stage ? (tempRes = this.childs, tempArrays = tempArrays.concat(tempRes)) : this instanceof Scene ? tempRes = [this] : tempArrays = this,\n    tempRes.forEach(function(tempItem) {\n      tempArrays = tempArrays.concat(tempItem.childs);\n    });\n  let result = null;\n  return result = 'function' == typeof condition ? tempArrays.filter(condition) : filterResults(tempArrays, condition),\n    result = invokeProperty(result);\n}\n\nmodule.exports = find;\n"]}