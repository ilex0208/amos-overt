var List=require("./_list"),_third=require("./_third"),animate={};animate.Animate=function(){this.current=0,this.step=8,this.delay=4,this.finishFunction=null,this.shouldBeFinished=!1,this.getCurrentDelay=function(){return this.delay*this.current+1},this.action=function(t){}},animate.AnimateProperty=function(t,i,e){this.objects=t,this.newValues=i,this.finishFunction=e,this.oldValues=new List;for(var n=this.objects.size(),o=0;o<n;o++){var s=this.objects.get(o);this.oldValues.add(this.getPropertyValue(s))}this.action=function(t){for(var i=this.objects.size(),e=0;e<i;e++){var n=this.objects.get(e),o=this.oldValues.get(e),s=this.newValues.get(e);this.currentAction(n,o,s,t)}},this.getPropertyValue=function(t){},this.currentAction=function(t,i,e,n){}},animate.AnimateBounds=function(t,i,e){this.node=t,this.newBounds=i,this.oldBounds=t.getRect(),this.finishFunction=e,this.shouldBeFinished=!0,this.action=function(t){var i=this.oldBounds,e=this.newBounds;this.node.setLocation(i.x+(e.x-i.x)*t,i.y+(e.y-i.y)*t),this.node.setSize(i.width+(e.width-i.width)*t,i.height+(e.height-i.height)*t)}},animate.AnimateCenterLocation=function(t,i,e){animate.AnimateCenterLocation.superClass.constructor.call(this,t,i,e),this.getPropertyValue=function(t){return t.getCenterLocation()},this.currentAction=function(t,i,e,n){var o=i.x+(e.x-i.x)*n,s=i.y+(e.y-i.y)*n;t.setCenterLocation(o,s)}},animate.AnimateLocation=function(t,i,e){animate.AnimateLocation.superClass.constructor.call(this,t,i,e),this.getPropertyValue=function(t){return t.getLocation()},this.currentAction=function(t,i,e,n){var o=i.x+(e.x-i.x)*n,s=i.y+(e.y-i.y)*n;t.setLocation(o,s)}},animate.AnimateScrollPosition=function(t,i,e){this.view=t,this.oldHorizontalOffset=t.scrollLeft,this.oldVerticalOffset=t.scrollTop,this.newHorizontalOffset=i,this.newVerticalOffset=e,this.action=function(t){this.view.scrollLeft=this.oldHorizontalOffset+(this.newHorizontalOffset-this.oldHorizontalOffset)*t,this.view.scrollTop=this.oldVerticalOffset+(this.newVerticalOffset-this.oldVerticalOffset)*t}},animate.AnimateZoom=function(t,i,e){this.view=t,this.oldZoom=t.getZoom(),this.newZoom=i,this.finishFunction=e,this.shouldBeFinished=!0,this.action=function(t){this.view.setZoom(this.oldZoom+(this.newZoom-this.oldZoom)*t,!1)}},animate.AnimateXZoom=function(t,i,e){this.view=t,this.oldXZoom=t.getXZoom(),this.newXZoom=i,this.finishFunction=e,this.shouldBeFinished=!0,this.action=function(t){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*t,!1)}},animate.AnimateYZoom=function(t,i,e){this.view=t,this.oldYZoom=t.getYZoom(),this.newYZoom=i,this.finishFunction=e,this.shouldBeFinished=!0,this.action=function(t){this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*t,!1)}},animate.AnimateXYZoom=function(t,i,e,n){this.view=t,this.oldXZoom=t.getXZoom(),this.newXZoom=i,this.oldYZoom=t.getYZoom(),this.newYZoom=e,this.finishFunction=n,this.shouldBeFinished=!0,this.action=function(t){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*t,!1),this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*t,!1)}},animate.AnimateSubNetwork=function(t,i,e){this.network=t,this.subNetwork=i,this.finishFunction=e,this.shouldBeFinished=!0,this.action=function(t){t>.5?(this.network.getView().style.opacity=2*t-1,this.network._setCurrentSubNetwork(this.subNetwork)):this.network.getView().style.opacity=1-2*t}},animate.AnimateManager={timer:null,animate:null,start:function(t,i){var e=animate.AnimateManager;t.current<0&&(t.current=0),i?_third.callLater(e.startImpl,null,[t],i):e.startImpl(t)},startImpl:function(t){var i=animate.AnimateManager;i.animate&&i.endAnimate(),i.animate=t,i.timer=setTimeout(i.tick,t.getCurrentDelay())},tick:function(){var t=animate.AnimateManager,i=t.animate;if(i)return i.current<0?void i.current++:(i.current<i.step&&(i.current++,i.action(i.current/i.step),t.timer=setTimeout(t.tick,i.getCurrentDelay())),void(i.current>=i.step&&t.endAnimate()))},endAnimate:function(){var t=animate.AnimateManager;if(t.animate){t.animate.shouldBeFinished&&t.animate.current<t.animate.step&&(t.animate.current=t.animate.step,t.animate.action(t.animate.current/t.animate.step));var i=t.animate.finishFunction;t.animate=null,t.timer&&(clearTimeout(t.timer),t.timer=null),i&&i()}else t.timer&&(clearTimeout(t.timer),t.timer=null)}},module.exports=animate;