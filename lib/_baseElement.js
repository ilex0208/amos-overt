function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function DisplayElement(){this.initialize=function(){DisplayElement.prototype.initialize.apply(this,arguments),this.elementType="displayElement",this.x=0,this.y=0,this.width=32,this.height=32,this.visible=!0,this.alpha=1,this.rotate=0,this.scaleX=1,this.scaleY=1,this.strokeColor="22,124,255",this.borderColor="22,124,255",this.fillColor="22,124,255",this.shadow=!1,this.shadowBlur=5,this.shadowColor="rgba(0,0,0,0.5)",this.shadowOffsetX=3,this.shadowOffsetY=6,this.transformAble=!1,this.zIndex=0;var t="x,y,width,height,visible,alpha,rotate,scaleX,scaleY,strokeColor,fillColor,shadow,shadowColor,shadowOffsetX,shadowOffsetY,transformAble,zIndex".split(",");this.serializedProperties=this.serializedProperties.concat(t)},this.initialize(),this.paint=function(t){t.beginPath(),t.fillStyle="rgba("+this.fillColor+","+this.alpha+")",t.rect(-this.width/2,-this.height/2,this.width,this.height),t.fill(),t.stroke(),t.closePath()},this.getLocation=function(){return{x:this.x,y:this.y}},this.setLocation=function(t,e){return this.x=t,this.y=e,this},this.getCenterLocation=function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},this.setCenterLocation=function(t,e){return this.x=t-this.width/2,this.y=e-this.height/2,this},this.getSize=function(){return{width:this.width,height:this.heith}},this.setSize=function(t,e){return this.width=t,this.height=e,this},this.getDimension=function(){return{width:this.width,height:this.height}},this.setDimension=function(t){var e=t||_default;return this.setSize(e,e),this},this.getBound=function(){return{left:this.x,top:this.y,right:this.x+this.width,bottom:this.y+this.height,width:this.width,height:this.height}},this.setBound=function(t,e,i,s){return this.setLocation(t,e),this.setSize(i,s),this},this.getDisplayBound=function(){return{left:this.x,top:this.y,right:this.x+this.width*this.scaleX,bottom:this.y+this.height*this.scaleY}},this.getDisplaySize=function(){return{width:this.width*this.scaleX,height:this.height*this.scaleY}},this.getPosition=function(t){var e=void 0,i=this.getBound();return"Top_Left"==t?e={x:i.left,y:i.top}:"Top_Center"==t?e={x:this.cx,y:i.top}:"Top_Right"==t?e={x:i.right,y:i.top}:"Middle_Left"==t?e={x:i.left,y:this.cy}:"Middle_Center"==t?e={x:this.cx,y:this.cy}:"Middle_Right"==t?e={x:i.right,y:this.cy}:"Bottom_Left"==t?e={x:i.left,y:i.bottom}:"Bottom_Center"==t?e={x:this.cx,y:i.bottom}:"Bottom_Right"==t&&(e={x:i.right,y:i.bottom}),e}}function InteractiveElement(){this.initialize=function(){InteractiveElement.prototype.initialize.apply(this,arguments),this.elementType="interactiveElement",this.dragable=!1,this.selected=!1,this.showSelected=!0,this.selectedLocation=null,this.isMouseOver=!1;var t="dragable,selected,showSelected,isMouseOver".split(",");this.serializedProperties=this.serializedProperties.concat(t)},this.initialize(),this.paintSelected=function(t){!1!==this.showSelected&&(t.save(),t.beginPath(),t.strokeStyle="rgba(168,202,255, 0.9)",t.fillStyle="rgba(168,202,236,0.7)",t.rect(-this.width/2-3,-this.height/2-3,this.width+6,this.height+6),t.fill(),t.stroke(),t.closePath(),t.restore())},this.paintMouseover=function(t){return this.paintSelected(t)},this.isInBound=function(t,e){return t>this.x&&t<this.x+this.width*Math.abs(this.scaleX)&&e>this.y&&e<this.y+this.height*Math.abs(this.scaleY)},this.selectedHandler=function(){this.selected=!0,this.selectedLocation={x:this.x,y:this.y}},this.unselectedHandler=function(){this.selected=!1,this.selectedLocation=null},this.dbclickHandler=function(t){this.dispatchEvent("dbclick",t)},this.clickHandler=function(t){this.dispatchEvent("click",t)},this.mousedownHander=function(t){this.dispatchEvent("mousedown",t)},this.mouseupHandler=function(t){this.dispatchEvent("mouseup",t)},this.mouseoverHandler=function(t){this.isMouseOver=!0,this.dispatchEvent("mouseover",t)},this.mousemoveHandler=function(t){this.dispatchEvent("mousemove",t)},this.mouseoutHandler=function(t){this.isMouseOver=!1,this.dispatchEvent("mouseout",t)},this.mousedragHandler=function(t){var e=this.selectedLocation.x+t.dx,i=this.selectedLocation.y+t.dy;this.setLocation(e,i),this.dispatchEvent("mousedrag",t)},this.addEventListener=function(t,e){var i=this,s=function(t){e.call(i,t)};return this.messageBus||(this.messageBus=new Util.MessageBus),this.messageBus.subscribe(t,s),this},this.dispatchEvent=function(t,e){return this.messageBus?(this.messageBus.publish(t,e),this):null},this.removeEventListener=function(t){this.messageBus.unsubscribe(t)},this.removeAllEventListener=function(){this.messageBus=new Util.MessageBus};var t="click,dbclick,mousedown,mouseup,mouseover,mouseout,mousemove,mousedrag,touchstart,touchmove,touchend".split(","),e=this;t.forEach(function(t){e[t]=function(e){null!=e?this.addEventListener(t,e):this.dispatchEvent(t)}})}function EditableElement(){this.initialize=function(){EditableElement.prototype.initialize.apply(this,arguments),this.editAble=!1,this.selectedPoint=null},this.getCtrlPosition=function(t){var e=5,i=5,s=this.getPosition(t);return{left:s.x-e,top:s.y-i,right:s.x+e,bottom:s.y+i}},this.selectedHandler=function(t){EditableElement.prototype.selectedHandler.apply(this,arguments),this.selectedSize={width:this.width,height:this.height},t.scene.mode==SceneMode.edit&&(this.editAble=!0)},this.unselectedHandler=function(){EditableElement.prototype.unselectedHandler.apply(this,arguments),this.selectedSize=null,this.editAble=!1};var t=["Top_Left","Top_Center","Top_Right","Middle_Left","Middle_Right","Bottom_Left","Bottom_Center","Bottom_Right"];this.paintCtrl=function(e){if(!1!==this.editAble){e.save();for(var i=0;i<t.length;i++){var s=this.getCtrlPosition(t[i]);s.left-=this.cx,s.right-=this.cx,s.top-=this.cy,s.bottom-=this.cy;var h=s.right-s.left,o=s.bottom-s.top;e.beginPath(),e.strokeStyle="rgba(0,0,0,0.8)",e.rect(s.left,s.top,h,o),e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle="rgba(255,255,255,0.3)",e.rect(s.left+1,s.top+1,h-2,o-2),e.stroke(),e.closePath()}e.restore()}},this.isInBound=function(e,i){if(this.selectedPoint=null,this.editAble===!0)for(var s=0;s<t.length;s++){var h=this.getCtrlPosition(t[s]);if(e>h.left&&e<h.right&&i>h.top&&i<h.bottom)return this.selectedPoint=t[s],!0}return EditableElement.prototype.isInBound.apply(this,arguments)},this.mousedragHandler=function(t){if(null==this.selectedPoint){var e=this.selectedLocation.x+t.dx,i=this.selectedLocation.y+t.dy;this.setLocation(e,i),this.dispatchEvent("mousedrag",t)}else{if("Top_Left"==this.selectedPoint){var s=this.selectedSize.width-t.dx,h=this.selectedSize.height-t.dy,o=this.selectedLocation.x+t.dx,n=this.selectedLocation.y+t.dy;o<this.x+this.width&&(this.x=o,this.width=s),n<this.y+this.height&&(this.y=n,this.height=h)}else if("Top_Center"==this.selectedPoint){var l=this.selectedSize.height-t.dy,r=this.selectedLocation.y+t.dy;r<this.y+this.height&&(this.y=r,this.height=l)}else if("Top_Right"==this.selectedPoint){var d=this.selectedSize.width+t.dx,a=this.selectedLocation.y+t.dy;a<this.y+this.height&&(this.y=a,this.height=this.selectedSize.height-t.dy),d>1&&(this.width=d)}else if("Middle_Left"==this.selectedPoint){var c=this.selectedSize.width-t.dx,u=this.selectedLocation.x+t.dx;u<this.x+this.width&&(this.x=u),c>1&&(this.width=c)}else if("Middle_Right"==this.selectedPoint){var f=this.selectedSize.width+t.dx;f>1&&(this.width=f)}else if("Bottom_Left"==this.selectedPoint){var p=this.selectedSize.width-t.dx,g=this.selectedLocation.x+t.dx;p>1&&(this.x=g,this.width=p);var y=this.selectedSize.height+t.dy;y>1&&(this.height=y)}else if("Bottom_Center"==this.selectedPoint){var m=this.selectedSize.height+t.dy;m>1&&(this.height=m)}else if("Bottom_Right"==this.selectedPoint){var v=this.selectedSize.width+t.dx;v>1&&(this.width=v);var x=this.selectedSize.height+t.dy;x>1&&(this.height=x)}this.dispatchEvent("resize",t)}}}var _defineProperties=require("babel-runtime/core-js/object/define-properties"),_defineProperties2=_interopRequireDefault(_defineProperties),Element=require("./_absElement"),Util=require("./_util"),Tobj=require("./_tobj"),SceneMode=Tobj.SceneMode,Constants=require("./constants/index"),_default=Constants.DEFAULT;DisplayElement.prototype=new Element,(0,_defineProperties2.default)(DisplayElement.prototype,{cx:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},cy:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}}),InteractiveElement.prototype=new DisplayElement,EditableElement.prototype=new InteractiveElement,module.exports={DisplayElement:DisplayElement,InteractiveElement:InteractiveElement,EditableElement:EditableElement};